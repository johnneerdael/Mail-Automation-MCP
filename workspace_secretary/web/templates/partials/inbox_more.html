<div id="more-emails-content">
{% for email in emails %}
<div class="flex items-start hover:bg-surface-hover active:bg-surface-active transition-colors border-t border-border">
    <label class="flex items-center px-3 py-4 cursor-pointer touch-manipulation self-stretch">
        <input type="checkbox" 
               value="{{ email.uid }}"
               data-folder="{{ email.folder }}"
               @change="toggleSelect('{{ email.uid }}', '{{ email.folder }}', $event.target.checked)"
               :checked="isSelected('{{ email.uid }}')"
               class="rounded bg-surface border-border text-primary focus:ring-primary">
    </label>
    <button hx-post="/api/email/toggle-star/{{ email.folder }}/{{ email.uid }}"
            hx-swap="none"
            hx-on::after-request="this.querySelector('span').textContent = event.detail.xhr.response.includes('true') ? 'â˜…' : 'â˜†'; this.querySelector('span').classList.toggle('text-yellow-400', event.detail.xhr.response.includes('true'))"
            class="flex items-center py-4 pr-1 touch-manipulation"
            title="Toggle star">
        <span class="text-lg {% if email.is_starred %}text-yellow-400{% else %}text-muted hover:text-muted-foreground{% endif %}">
            {% if email.is_starred %}â˜…{% else %}â˜†{% endif %}
        </span>
    </button>
    <a href="/thread/{{ email.folder }}/{{ email.uid }}" 
       class="flex-1 py-3 pr-3 sm:pr-4 touch-manipulation">
        <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-1 sm:gap-0">
            <div class="flex items-start sm:items-center min-w-0 flex-1">
                {% if email.is_unread %}
                <span class="w-2 h-2 bg-primary rounded-full mr-2 sm:mr-3 flex-shrink-0 mt-1.5 sm:mt-0"></span>
                {% else %}
                <span class="w-2 h-2 mr-2 sm:mr-3 flex-shrink-0"></span>
                {% endif %}
                
                <div class="min-w-0 flex-1">
                    <div class="flex items-center justify-between sm:justify-start gap-2">
                        <p class="text-sm font-medium truncate {% if email.is_unread %}text-default font-semibold{% else %}text-muted-foreground{% endif %}">
                            {{ email.from_name or email.from_addr }}
                        </p>
                        <div class="flex items-center gap-1 sm:hidden flex-shrink-0">
                            {% if email.has_attachments %}
                            <span class="text-muted text-xs">ðŸ“Ž</span>
                            {% endif %}
                            <span class="text-xs text-muted">{{ email.date }}</span>
                        </div>
                    </div>
                    
                    <p class="text-sm truncate mt-0.5 {% if email.is_unread %}text-default font-semibold{% else %}text-muted-foreground{% endif %}">
                        {{ email.subject }}
                    </p>
                    {% if email.preview %}
                    <p class="text-xs sm:text-sm text-muted truncate mt-0.5 hidden sm:block">
                        {{ email.preview }}
                    </p>
                    {% endif %}
                </div>
            </div>
            
            <div class="hidden sm:flex ml-4 items-center space-x-2 flex-shrink-0">
                {% if email.has_attachments %}
                <span class="text-muted" title="Has attachments">ðŸ“Ž</span>
                {% endif %}
                <span class="text-sm text-muted">{{ email.date }}</span>
            </div>
        </div>
    </a>
</div>
{% endfor %}
</div>

{% if has_more %}
<div hx-get="/inbox/more?page={{ page + 1 }}&folder={{ folder }}&unread_only={{ unread_only }}"
     hx-trigger="revealed"
     hx-swap="outerHTML"
     class="flex justify-center py-4">
    <span class="text-sm text-muted">Loading more...</span>
</div>
{% endif %}
